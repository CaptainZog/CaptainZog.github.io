<html>
<head>
    <script src='https://d3js.org/d3.v5.min.js'></script>
    <style type="text/css">
        circle {
            fill: lightblue;
            stroke: black;
        }

        #tooltip {
            position: absolute;
            width: 200px;
            height: auto;
            padding: 10px;
            background-color: white;
            -webkit-border-radius: 10px;
            -moz-border-radius: 10px;
            border-radius: 10px;
            -webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
            -moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
            box-shadow: 4px 4px 10px rgba(0, 100, 100, 0.4);
            pointer-events: none;
        }

            #tooltip.hidden {
                display: none;
            }

            #tooltip p {
                margin: 0;
                font-family: sans-serif;
                font-size: 16px;
                line-height: 20px;
            }
    </style>
</head>
<body onload='init()'>
    <h1>Narrative Visualization v2</h1>
    <div id="tooltip" class="hidden">
        <p><strong id="tooltipHeader">Tooltip Header</strong></p>
        <p><span id="tooltipText">Tooltip Text</span></p>
    </div>
    <svg width=300 height=300></svg>

    <script>
        async function init() {

           // data = await d3.csv("StateCounties/cc-est2019-agesex-01.csv");
            data = await d3.csv("http://CaptainZog.github.io/StateCounties/cc-est2019-agesex-01.csv");
           // C:\GitHub\CaptainZog.github.io\StateCounties

            var tooltip = d3.select("#tooltip");
            var xScale = d3.scaleLog().domain([10, 150]).range([0, 200]);
            var yScale = d3.scaleLog().domain([10, 150]).range([200, 0]);

            d3.select("svg")
                .append("g").attr("transform", "translate(50,50)")
                .selectAll("circle")
                .data(data)
                .enter()
                .append("circle")
                .attr("cx", function (d, i) { return xScale(i); })
                .attr("cy", function (d, i) { return yScale(i); })
                .attr("r", function (d) { return 2 + parseInt(d.POPESTIMATE) / 10000; })
                .on("mouseover", function (d, i) {
                    tooltip.classed("hidden", false)
                        .style("left", (d3.event.pageX) + "px")
                        .style("top", (d3.event.pageY) + "px")
                        .select("#tooltipHeader").text(d.Make);
                    tooltip.select("#tooltipText").html("Cylinders: " + d.EngineCylinders + "<br />Highway: " + d.AverageHighwayMPG);
                })
                .on("mouseout", function () { tooltip.classed("hidden", true); });

            d3.select("svg")
                .append("g").attr("transform", "translate(50,50)")
                .call(d3.axisLeft(yScale).tickValues([10, 20, 50, 100]).tickFormat(d3.format("~s")));

            d3.select("svg")
                .append("g").attr("transform", "translate(50,250)")
                .call(d3.axisBottom(xScale).tickValues([10, 20, 50, 100]).tickFormat(d3.format("~s")));
        }
    </script>
</body>
</html>
